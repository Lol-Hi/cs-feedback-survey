#Importing other libraries
import openpyxl #allows me to read from an Excel spreadsheet

def openExcel(filename, sheetname):
    """
    Reads the responses from the allocated excel sheet
    Returns a 2D list containing the responses for each question

    >>> openExcel("responses_testing.xlsx", "Form responses 1")
    [['Your Name', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden', 'Hidden'], ['I would like to own a Microbit set for my own learning', 4, 4, 5, 1, 2, 2, 5, 5, 3, 5, 5, 5, 5, 5, 5, 3, 4, 5, 5, 3, 4, 5, 3, 4, 1, 5, 5, 4, 4, 3, 5, 4, 3, 2, 4, 5, 4, 3, 5, 2, 1, 2, 5, 4, 5, 5, 4, 4, 5, 2, 4, 3, 4, 4, 4, 3, 2, 2, 4, 5, 5, 3, 5, 3, 1, 4, 1, 5, 4, 5, 5, 5, 5, 3, 4, 3, 3, 4, 3, 3, 5, 5, 3, 3, 3, 5, 1, 3, 3, 5, 4, 5, 5, 5, 3, 5, 5, 5, 3, 5, 5, 5, 4, 2, 4, 5, 5, 2, 5, 3, 5, 3, 3, 5, 4, 5, 2, 4, 5, 5, 4, 4, 4, 5, 5, 2, 3, 4, 3, 1, 3, 2, 5, 5, 2, 5, 3, 4, 4, 5, 4, 3, 4, 5, 5, 1, 3, 3, 5, 5, 5, 5, 3, 2, 3, 3, 3, 3, 5, 3, 3, 3, 2, 2, 5, 5, 5, 5, 1, 3, 3, 3, 4, 5, 5, 5, 4, 4, 4, 2, 5, 5, 4, 5, 5, 5, 5, 5, 5, 4, 3, 5, 3, 4, 3, 5, 5, 3, 5, 3, 5], ['I would consider using Microbit for my future school projects ', 'Maybe', 'Yes', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Yes', 'Yes', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Yes', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'No', 'No', 'Yes', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'No', 'Maybe', 'Yes', 'Yes', 'Maybe', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Yes', 'Yes', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Yes', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Yes', 'Yes', 'Maybe', 'No', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'No', 'Yes', 'Maybe', 'Maybe', 'No', 'Maybe', 'Yes', 'Yes', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'No', 'Maybe', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Maybe', 'No', 'Maybe', 'Yes', 'Yes', 'Yes', 'No', 'Maybe', 'Yes', 'Yes', 'Maybe', 'Yes', 'Yes', 'Maybe', 'No', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'No', 'Maybe', 'No', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'No', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Yes', 'Yes', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Yes', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Maybe', 'Yes', 'Maybe', 'Yes', 'Maybe', 'Maybe', 'Maybe', 'Yes'], ['What was your favourite part of the course?', 'shooting game', 'Learning about the shooting game', 'Everything', 'Learning how to use the game block.', 'The games! :PPP', 'Everything.', 'Programming', 'The coding', 'The use of the microbit to play the game I created.', 'The project ', 'trying to code the microbit', 'Programming the microbit', 'the prentation', 'Programming the shooting game', 'Our projects', 'When we were working on projects.', 'The creation of the flappy bird code', 'The computer', 'Programming', 'Coding and decryption (Radio)', 'Probably everything', 'NIL', 'The project', 'Learning new techinal skills', 'Using the computer', 'Individual project', 'Learning about different aspects of programming', 'Learning how to code new games.', 'The Project', 'The decoding lesson', 'getting to know how to code complicated codes', 'Experimenting with the codes.', 'Trying to learn to write Javascript through the blocks system', 'My favourite part of the course was doing the caesar decoder as it was quite challenging and made me think about my code.', 'Making games', 'Learning how to make games on microbit', 'the programming', 'Learning how to program games using microbit', 'I enjoy making games, such as flappy bird throughout the course. I also enjoy the  process of learning different functions, such as array, something I did not learn in Scratch.', 'Learning about making games', 'The project making', 'Making games.', 'making the games', 'The microbit assignment at the end of the module', 'Creation of the games', 'When i was working on the final microbit project', '-', 'The challenges the teacher assigned.', 'making a game\n', 'making games', 'The microbit tryouts', 'the part where it ended', 'Being able to learn how to successfully program a microbit gives a sense of accomplishment.', 'learning about different coding blocks', 'The assignment', 'The Individual Microbit Project', 'Variables', 'Programming', 'The project', 'Creating the bullet game for the assignment (summative)', 'making games', 'ceaser cypher', 'getting to code ', 'Loops and Logic', 'When we were allowed to use the computers', 'The programming and trial and error part of the coding that was fun and exciting.', 'Everything', 'when we learnt the game for fighting and shooting aliens ', 'The individual assignment', 'I like building games', 'na', 'It was fun and enjoyable, the activities we did with the micro-bit was very interactive and fun.', 'Programming games on the Microbit', 'When we tried to decode a message.', 'THE PART WHEN WE START PROGRAMMING', 'Making fun programs with microbit.', 'Posting a YouTube video', 'Caesar Cipher', 'Getting to programme.', 'making a game', 'Creating the Flappy Bird Game', 'getting points', '\n   Learning how to programme games', 'The summative when creating your own game or code', 'The fun activities.', 'programming', 'Lessons', 'Making the code for the game', 'Programming the shooting game', 'Learning about microbits', 'The find the boat thing', 'Trying my hands on coding the microbit!', 'bonus raw marks for homework', 'The part where we had to decipher the code', 'Learning to code', 'learning microbit', 'the teacher', 'nill', 'the part when we can watch utube', 'The video', 'Playing Games', 'The project', 'the last few weeks because we got to use our creativity to combine everything we learnt.', 'Programming the game at the end of the course', 'hands-on tasks', 'Group work/games', 'The last few lessons were less stressful because there were more time to do our projects. ', 'Learning how to make games.', 'Learning and using arrays', 'Learning about variables', 'Programming', 'Using the computers to play games on the sly.', 'actually using the micro bit\n', 'The challenges', 'creating game codes', 'the project', 'Learning about coding', 'Learning to code', 'Creating new projects with microbit', 'The making game part.', 'My favourite part of the course was when i got to experiment for myself using microbit.org to make my own codes.', 'creating games', 'The creating of games on microbit.', 'Playing the games that is coded on the microbit.', 'The Project and the last lesson.', 'using computers', 'Seeing my codes work', 'The favourite part of the course was the flappy bird. ', 'Using the microbit simulator', 'The part before we learnt about Microbit', 'The final project', 'Coding Project!', 'Using an actual Microbit', 'learning to code', 'Learning how to code Flappy Bird.', 'Creating games', 'Being able to think of new solutions to the same problem', 'idk', 'Learning about variables', 'Individual project', 'Coding complicated games.', 'I like the lesson when we get to use the microbit.', 'My favourite part of the course was solving the challenge homework questions (e.g. Card games and AI) which really stretched my coding skills further and put it into perspective for me as a fun and useful part of our daily lives. Similarly, the process of coding my own games and programs allowed me to learn about troubleshooting.', 'Learning how to use Microbit together with programs.', 'Coding games and removing bugs in the coding', 'watching the video', 'learning how to code games', 'Own project', 'The blackjack and using knowledge to create your own games!', 'Learning how to code games.', 'Creating new programmes', 'The project - coding was very enjoyable', 'The hands on activities', 'Hardware', 'Programming the last assignment', 'The lessons', 'Hardware', 'Programming games and using the tinker kits', 'Learning about several coding parts in Microbit (arrays, loops), learning about things like algorithms', 'When I could present solutions which were practical and understandable ', 'solving the problems and doing the assignments at home. ', 'The lessons', 'Learning how to make games.', 'Working with the computers to programme games', 'It was the project part because you can create any game you want.', 'Being able to see my end project', 'Learning how to make games', 'Making my own game', 'The video', 'Logic', 'Exploring the set', 'Making my own game', 'Videos', 'Final project, multiplayer game with Putra', 'Playing with Microbit set', 'Everything', 'Homework assignments where we are given a problem to be solved with the use of a microbit, which we must solve.', 'we tried out many different use of microbits to solve out daily problems', 'programming games', 'learning to code games', 'Learning the different uses of the codes', 'Doing multiplayer projects w/ Yu Chen', 'Learning about the use for different programming functions', 'Learning about how to program using Javascript, although I did not learn much.', 'The video on algorhithms', 'Using the microbit', 'Using microbit.', 'Learning to code', 'Using the microbit', 'Coding programmes and games we want', 'Microbit', 'Using microbit', 'Using the actual microbit ', 'The bonus marks', 'The making of the project ', 'Programming!', 'Using the physical Microbit', 'I like the teacher', 'Coding', 'Coding games', 'Microbit']]
    >>> openExcel("hello.xlsx", "world")
    Error: hello.xlsx not found
    'ERROR'
    >>> openExcel("responses_testing.xlsx", "world")
    Error: 'world' not found in responses_testing.xlsx
    'ERROR'
    """
    try:
        workbook = openpyxl.load_workbook(filename) #opens the required Excel file
    except:
        print("Error: {} not found".format(filename))
        return "ERROR"
    if sheetname in workbook.sheetnames:
        sheet = workbook[sheetname] #opens the required Excel spreadsheet
    else:
        print("Error: '{}' not found in {}".format(sheetname, filename))
        return "ERROR"
    sheetList = [ ] #initialises the output 2D array
    columnCount = 0 #keeps count of the current column being read (the question whose responses are currently read)
    for column in list(sheet.columns): #iterates through the columns (questions)
        sheetList.append([ ]) #adds a list to store all the responses for the question
        for cell in list(column): #iterates through each response for the current question
            sheetList[columnCount].append(cell.value) #stores each response to the list for the current question
        columnCount += 1 #updates the column (question) count
    return sheetList #returns the 2D array containing all the responses


